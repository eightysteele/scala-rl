<html><head><title>ScalaRL: Planning and Learning with Tabular Methods</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Sam Ritchie" /><meta name="description" content="Reinforcement Learning in Scala." /><meta name="og:image" content="/img/poster.png" /><meta name="image" property="og:image" content="/img/poster.png" /><meta name="og:title" content="ScalaRL: Planning and Learning with Tabular Methods" /><meta name="title" property="og:title" content="ScalaRL: Planning and Learning with Tabular Methods" /><meta name="og:site_name" content="ScalaRL" /><meta name="og:url" content="http://www.scalarl.com/" /><meta name="og:type" content="website" /><meta name="og:description" content="Reinforcement Learning in Scala." /><link rel="icon" type="image/png" href="/img/favicon.png" /><meta name="twitter:title" content="ScalaRL: Planning and Learning with Tabular Methods" /><meta name="twitter:image" content="http://www.scalarl.com/img/poster.png" /><meta name="twitter:description" content="Reinforcement Learning in Scala." /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:site" content="@scalaRLProject" /><meta name="twitter:creator" content="@sritchie" /><link rel="icon" type="image/png" sizes="16x16" href="/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/img/favicon310x150.png" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/css/light-style.css" /><script async="async">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-146772284-1' , 'auto');
ga('send', 'pageview');
      </script></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><div id="sidebar-brand"><a href="/" class="brand"><div class="brand-wrapper"></div><span>ScalaRL</span></a><button id="main-toggle" class="sidebar-toggle"><span class="close"></span></button></div><div class="sidebar-nav">      <div class="sidebar-nav-item  "><a href="/course.html" title="Functional RL in Scala" class="">Functional RL in Scala</a></div> <div class="sidebar-nav-item  open"><a href="/course/tabular.html" title="Tabular Methods" class="drop-nested">Tabular Methods</a><i class="fa fa-angle-right"></i><div class="sub-section"> <a href="/course/tabular/bandits.html" title="Multi-armed Bandits" class="">Multi-armed Bandits</a> <a href="/course/tabular/finite_mdps.html" title="Finite Markov Decision Processes" class="">Finite Markov Decision Processes</a> <a href="/course/tabular/dynamic_programming.html" title="Dynamic Programming" class="">Dynamic Programming</a> <a href="/course/tabular/monte_carlo.html" title="Monte Carlo Methods" class="">Monte Carlo Methods</a> <a href="/course/tabular/td_learning.html" title="Temporal Difference Learning" class="">Temporal Difference Learning</a> <a href="/course/tabular/n_step_bootstrapping.html" title="n-step Bootstrapping" class="">n-step Bootstrapping</a> <a href="/course/tabular/tabular_methods.html" title="Planning and Learning with Tabular Methods" class="active">Planning and Learning with Tabular Methods</a></div></div></div></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/sritchie/scala-rl" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/sritchie/scala-rl" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="sritchie" data-github-repo="scala-rl"><div class="content-wrapper"><section><h1 id="planning-and-learning-with-tabular-methods">Planning and Learning with Tabular Methods</h1>

<h1 id="warning">WARNING!</h1>

<p>Note - this is VERY EARLY DAYS! All of the files in the course with this warning are the raw, totally unprocessed notes that I generated during my first reading of “Reinforcement Learning: An Introduction”.</p>

<p>I’ll be converting these into proper course sections with wonderful embedded code that you can try out. I’m not there yet, but I wanted to develop all of this in the open.</p>

<p>Maybe you’ll find these notes interesting, but don’t expect anything special… yet!</p>

<h2 id="notes">Notes</h2>

<p>iirc this is more of a summary of everything that came before, yes, uniting it into the big approach.</p>

<h2 id="chapter-sketch">Chapter Sketch</h2>

<p>There is a ton in here. Does this unify, or should I chill out and go back to the good stuff? Try to get a feel for what this is introducing… then I can start coding.</p>

<p>We start with tabular dyna-Q, then slowly make it more complicated.</p>

<h2 id="models-and-planning">Models and Planning</h2>

<p>This introduces the idea that models let you plan but updating your state-value or action-value functions based on predictions… the map is not the territory, but you can increase your understanding of the map.</p>

<p>We are now back to the idea of a model, vs an actual environment to interact with. How interesting, similar to consciousness, here… we are always interacting with the model, and then some separate process behind the scenes is updating the model to be more like the real world.</p>

<ul>
  <li>distribution models</li>
  <li>sample models</li>
</ul>

<p>Remember the two?</p>

<p>Can you just draw a reward/state pair? Or do you get the entire distribution to look at? That’s the difference.</p>

<p>Planning - take either a model or (model, policy) and produces an improved policy.</p>

<ul>
  <li>there is also a thing called a PLAN SPACE MODEL, which we don’t consider further, but this seems super cool. You have functions from plans to plans??</li>
</ul>

<p>demo - random-sample one-step tabular Q-planning.</p>

<p>planning in very small steps, too. They love online.</p>

<h3 id="dyna-integrated-planning-acting-and-learning">Dyna: Integrated Planning, Acting, and Learning</h3>

<p>Dyna-Q.</p>

<p>There are two functions for real-world experience:</p>

<ul>
  <li>improve the model</li>
  <li>directly improve the value function.</li>
</ul>

<p>What is tabular Dyna-Q? (obviously this is an interface, and we should be able to plug in various versions!)</p>

<ul>
  <li>planning method? one-step tabular q-planning</li>
  <li>direct RL? one-step tabular Q-learning</li>
  <li>The MODEL is super dumb and just assumes a deterministic transition - whatever happened last time will happen again, for (s, a) =&gt; (r, s)</li>
</ul>

<p>Okay, I’m going to need to implement this to explain it more clearly. Go back here and get the interface going.</p>

<h2 id="when-the-model-is-wrong">When the Model is Wrong</h2>

<p>The model above can be wrong with stochastic info, or with very little info to build a stochastic model.</p>

<p>If you have a fucked up model usually you will run into a clash with reality, and that will correct the model.</p>

<p>A worse thing is when the environment becomes BETTER than it was before, and we don’t get to adjust in time.</p>

<p>Well, we can give a reward bonus. That is a nice way to deal. And implement the measurement i guess that shows how it gets better?</p>

<h2 id="prioritized-sweeping">Prioritized Sweeping</h2>

<p>okay, before we were doing a sweep that just randomly selected states from what we saw before.</p>

<p>We really want to work backward from any state whose value has just changed. That is where we can ripple the updates from.</p>

<p>Does that imply that we want a distance metric? That would help, right?</p>

<p>A function to get the set of states that are blah steps away? A graph model really would be nice in this case.</p>

<p>algorithm on page 170… can we do this better?</p>

<p>“sample updates”, page 171.</p>

<h2 id="expected-vs-sample-updates">Expected vs Sample Updates</h2>

<p>I guess we get here into what sample updates actually are.</p>

<p>Oh, this is at the end… do we want to just sample at the VERY end, or do we use the expectation give the model?</p>

<p>What if we sample within quantiles or something? We don’t weight everything? That is, again, a way to get a sample model…</p>

<p>Do we need to do any testing here?</p>

<p>Maybe just make sure that our code harness COULD test this stuff.</p>

<h2 id="trajectory-sampling">Trajectory Sampling</h2>

<p>Sample according to the current policy, within the model! This is called trajectory sampling.</p>

<p>vast, boring parts of the state-space are ignored.</p>

<h2 id="real-time-dynamic-programming">Real-time Dynamic Programming</h2>

<p>Another algo that we can talk about, complicated, get into it if we decide to show this off. Page 178 shows the goodies.</p>

<h2 id="planning-at-decision-time">Planning at Decision Time</h2>

<p>We’ve been talking about background planning; you can give a budget here and plan away in the background.</p>

<p>Woah… what if we use planning, based on the model, to roll forward? Use the CURRENT STATE in the actual game, like chess or something, to decide what move to do?
Do you plan at decision time, when given a state? Or do you plan ahead of time, trying to guess what states you’ll be in, and then rapidly get after it?</p>

<h2 id="heuristic-search">Heuristic Search</h2>

<p>Classic decision time algos!</p>

<p>Implement this shit, and save the results.</p>

<h2 id="rollout-algorithms">Rollout Algorithms</h2>

<blockquote>
  <p>Rollout algorithms are decision-time planning algorithms based on Monte Carlo control applied to simulated trajectories that all begin at the current environment state. (p. 183)</p>
</blockquote>

<p>They do a ton of monte-carlo guesses and then use that info to decide whether or not to store the value functions.</p>

<p>This comes from Backgammon, where you “roll out” the dice a bunch of times to see what might happen next.</p>

<p>There is a rollout policy…</p>

<p>Figure out how this works, implement once I have my existing goodies.</p>

<p>You want to save info?</p>

<h2 id="monte-carlo-tree-search">Monte Carlo Tree Search</h2>

<p>Well, you should do monte carlo tree search.</p>

<p>This is an amazing one that I definitely can’t wait to implement! And now we are into some serious modern shit.</p>

<h2 id="summary-of-part-1">Summary of Part 1</h2>

<p>Woah, what a haul.</p>

<p>Lots of different dimensions… p.191 covers these. There is so much to cover in this fucking reinforcement learning writeup! I am going to be such a stud if I can tackle all of this. I just need to be coding and writing all the time, now… And getting my neural network stuff down.</p>

<h2 id="programming-exercises">Programming Exercises</h2>

<ul>
  <li>function to go from a distribution model to a sample model. (these should be graphs so we can do breadth first searches out from areas that have changed.)</li>
  <li>interfaces for sample and distribution models?</li>
  <li>q-planning, page 161</li>
  <li>dyna-Q</li>
  <li>dyna-Q+, with a bonus that encourages exploration.</li>
  <li>have the bonus implemented in different spots… just like in ex 8.4</li>
  <li>trajectory sampling.</li>
  <li>replicate figure 8,8…I have the code, do it in scala, change b=3.</li>
  <li>RTDP on the racetrack, show that off!</li>
  <li>heuristic search.</li>
</ul>
</section><div class="edit-button"><a href="https://github.com/sritchie/scala-rl/edit/develop/docs/src/main/tut/course/tabular/tabular_methods.md" target="_blank" rel="noopener noreferrer" class="btn-sm btn-info">Help us improve this page</a></div></div></div></div></div><script src="/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
              </script><script src="/js/mathjax.js"></script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script>((window.gitter = {}).chat = {}).options = {
room: 'ScalaRL/community'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/js/docs.js"></script></body></html>